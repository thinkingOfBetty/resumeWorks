{"code":"!function(t){var e={};function r(s){if(e[s])return e[s].exports;var i=e[s]={i:s,l:!1,exports:{}};return t[s].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,e,s){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:s})},r.r=function(t){Object.defineProperty(t,\"__esModule\",{value:!0})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,\"a\",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p=\"\",r(r.s=5)}([function(t,e,r){\"use strict\";r.r(e),r.d(e,\"DataStore\",function(){return s});class s{}},function(t,e,r){\"use strict\";r.r(e),r.d(e,\"Sprite\",function(){return i});var s=r(0);class i{constructor(t=null,e=0,r=0,i=0,a=0,n=0,o=0,c=0,h=0){this.dataStore=s.DataStore.getInstance(),this.ctx=this.dataStore.ctx,this.img=t,this.srcX=e,this.srcY=r,this.srcW=i,this.srcH=a,this.x=n,this.y=o,this.width=c,this.height=h}static getImage(t){return s.DataStore.getInstance().res.get(t)}draw(t=this.img,e=this.srcX,r=this.srcY,s=this.srcW,i=this.srcH,a=this.x,n=this.y,o=this.width,c=this.height){this.ctx.drawImage(t,e,r,s,i,a,n,o,c)}}},,,,function(t,e,r){\"use strict\";r.r(e);var s=r(0),i=r(1);class a extends i.Sprite{}class n extends a{}class o extends a{}r.d(e,\"Director\",function(){return c});class c{static getInstance(){return c.instance||(c.instance=new c),c.instance}constructor(){this.dataStore=s.DataStore.getInstance(),this.moveSpeed=2}createPencil(){const t=s.DataStore.getInstance().canvas.height/8,e=s.DataStore.getInstance().canvas.height/2,r=t+Math.random()*(e-t);this.dataStore.get(\"pencils\").push(new n(r)),this.dataStore.get(\"pencils\").push(new o(r))}birdsEvent(){for(let t=0;t<=2;t++)this.dataStore.get(\"birds\").y[t]=this.dataStore.get(\"birds\").birdsY[t];this.dataStore.get(\"birds\").time=0}static isStrike(t,e){let r=!1;return(t.top>e.bottom||t.bottom<e.top||t.right<e.left||t.left>e.right)&&(r=!0),!r}check(){const t=this.dataStore.get(\"birds\"),e=this.dataStore.get(\"land\"),r=this.dataStore.get(\"pencils\"),s=this.dataStore.get(\"score\");if(t.birdsY[0]+t.birdsHeight[0]>=e.y)return console.log(\"撞击地板啦\"),void(this.isGameOver=!0);const i={top:t.y[0],bottom:t.birdsY[0]+t.birdsHeight[0],left:t.birdsX[0],right:t.birdsX[0]+t.birdsWidth[0]},a=r.length;for(let t=0;t<a;t++){const e=r[t],s={top:e.y,bottom:e.y+e.height,left:e.x,right:e.x+e.width};if(c.isStrike(i,s))return console.log(\"撞到水管啦\"),void(this.isGameOver=!0)}t.birdsX[0]>r[0].x+r[0].width&&s.isScore&&(wx.vibrateShort({success:function(){console.log(\"振动成功\")}}),s.isScore=!1,s.scoreNumber++)}run(){if(this.check(),this.isGameOver)console.log(\"游戏结束\"),this.dataStore.get(\"startButton\").draw(),cancelAnimationFrame(this.dataStore.get(\"timer\")),this.dataStore.destroy(),wx.triggerGC();else{this.dataStore.get(\"background\").draw();const t=this.dataStore.get(\"pencils\");t[0].x+t[0].width<=0&&4===t.length&&(t.shift(),t.shift(),this.dataStore.get(\"score\").isScore=!0),t[0].x<=(s.DataStore.getInstance().canvas.width-t[0].width)/2&&2===t.length&&this.createPencil(),this.dataStore.get(\"pencils\").forEach(function(t){t.draw()}),this.dataStore.get(\"land\").draw(),this.dataStore.get(\"score\").draw(),this.dataStore.get(\"birds\").draw();let e=requestAnimationFrame(()=>this.run());this.dataStore.put(\"timer\",e)}}}}]);","extractedComments":[]}